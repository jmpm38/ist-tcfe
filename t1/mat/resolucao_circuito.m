R1=1.04899828982*1000;
R2=2.0555682231*1000;
R3=3.06018802573*1000;
R4=4.16897961659*1000;
R5=3.07395007732*1000;
R6=2.0428100493*1000;
R7=1.03756256625*1000;

Kb=7.33855517177/1000;
Kc=8.25818000183*1000;

Id=1.01155034907*0.001;
Va=5.11422921556;

A=[ 1/R5 0 Kb 0 0 0 -(1/R5)-Kb; 0 1/R2 -Kb-(1/R2) 0 0 0 Kb; 0 -1/R2 (1/R2)+(1/R1)+(1/R3) -(1/R1) 0 0 -(1/R3); 0 0 0 0 -(1/R6) (1/R7)+(1/R6) 0; -(1/R5) 0 -(1/R3) 0 -(1/R4) -(1/R7) (1/R5)+(1/R4)+(1/R3); 0 0 0 1 -1 0 0; 0 0 0 0 0 Kc*(1/R7) -1]

B=[Id; 0; 0; 0; -Id; Va; 0]

x=inv(A)*B


C=[R1+R3+R4 R3 R4 0; R4 0 R4+R6+R7-Kc 0; R3*Kb R3*Kb-1 0 0; 0 0 0 1]

D=[Va; 0; 0; -Id]

y=inv(C)*D
